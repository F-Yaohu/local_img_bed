
# Local Image Bed - æœ¬åœ°ä¸ªäººå›¾åºŠ

![Java](https://img.shields.io/badge/Java-17-blue)
![Spring Boot](https://img.shields.io/badge/Spring%20Boot-3.3.1-brightgreen)
![React](https://img.shields.io/badge/React-18.3.1-blue)
![MySQL](https://img.shields.io/badge/MySQL-5.7.40-orange)
![Docker](https://img.shields.io/badge/Docker-blue)

è¿™æ˜¯ä¸€ä¸ªåŠŸèƒ½å®Œå–„çš„ä¸ªäººå›¾åºŠåº”ç”¨ï¼ŒåŸºäº Spring Boot å’Œ React æŠ€æœ¯æ ˆæ„å»ºã€‚å®ƒå…è®¸ç”¨æˆ·è½»æ¾ä¸Šä¼ ã€ç®¡ç†å’Œåˆ†ç±»è‡ªå·±çš„å›¾ç‰‡èµ„æºï¼Œå¹¶æä¾›ç¨³å®šå¯é çš„å›¾ç‰‡å¤–é“¾æœåŠ¡ã€‚é¡¹ç›®æ”¯æŒä½¿ç”¨ Docker è¿›è¡Œä¸€é”®éƒ¨ç½²ï¼Œæå¤§ç®€åŒ–äº†ç¯å¢ƒé…ç½®çš„å¤æ‚æ€§ã€‚

## âœ¨ åŠŸèƒ½ç‰¹æ€§

- **å›¾ç‰‡ä¸Šä¼ **ï¼šæ”¯æŒæ‹–æ‹½ã€ç‚¹å‡»é€‰æ‹©ç­‰å¤šç§æ–¹å¼ä¸Šä¼ å›¾ç‰‡ï¼Œå¹¶å®æ—¶æ˜¾ç¤ºä¸Šä¼ è¿›åº¦ã€‚
- **åˆ†ç±»ç®¡ç†**ï¼šæ”¯æŒæ ‘çŠ¶åˆ†ç±»ç»“æ„ï¼Œå¯ä»¥æ–¹ä¾¿åœ°å¯¹å›¾ç‰‡è¿›è¡Œå½’ç±»æ•´ç†ã€‚
- **å›¾ç‰‡ç®¡ç†**ï¼šä»¥ç€‘å¸ƒæµå½¢å¼å±•ç¤ºå›¾ç‰‡ï¼Œæ”¯æŒå›¾ç‰‡çš„é¢„è§ˆã€å¤åˆ¶é“¾æ¥ã€åˆ é™¤ç­‰æ“ä½œã€‚
- **ç›¸ä¼¼å›¾ç‰‡æŸ¥æ‰¾**ï¼šæä¾›æŸ¥æ‰¾ç›¸ä¼¼å›¾ç‰‡çš„åŠŸèƒ½ï¼ˆéœ€è¦é¢å¤–é…ç½®ï¼‰ã€‚
- **å“åº”å¼è®¾è®¡**ï¼šå‰ç«¯ç•Œé¢é€‚é…ä¸åŒå°ºå¯¸çš„è®¾å¤‡ã€‚
- **å®¹å™¨åŒ–éƒ¨ç½²**ï¼šæä¾› `Dockerfile` å’Œ `docker-compose.yml`ï¼Œæ”¯æŒä¸€é”®éƒ¨ç½²ã€‚

## ğŸ“¸ é¢„è§ˆ

| ä¸»é¡µé¢                                                                                                                                                  | åˆ†ç±»ç®¡ç† |
|------------------------------------------------------------------------------------------------------------------------------------------------------|---|
| ![ä¸»ç•Œé¢é¢„è§ˆ](https://raw.githubusercontent.com/F-Yaohu/local_img_bed/refs/heads/master/%E9%A2%84%E8%A7%88%E5%9B%BE/2577a4f481980a4570423e413e840869.png) | ![åˆ†ç±»ç®¡ç†é¢„è§ˆ](https://raw.githubusercontent.com/F-Yaohu/local_img_bed/refs/heads/master/%E9%A2%84%E8%A7%88%E5%9B%BE/13aaac6c010242f213e63ded3822a830.png) |
| **ç³»ç»Ÿè®¾ç½®**                                                                                                                                             | **å›¾ç‰‡é¢„è§ˆ** |
| ![ç³»ç»Ÿè®¾ç½®](https://raw.githubusercontent.com/F-Yaohu/local_img_bed/refs/heads/master/%E9%A2%84%E8%A7%88%E5%9B%BE/65d51195e84fd97f711e931d397b4a9f.png)  | ![å›¾ç‰‡é¢„è§ˆ](https://raw.githubusercontent.com/F-Yaohu/local_img_bed/refs/heads/master/%E9%A2%84%E8%A7%88%E5%9B%BE/623f4e675a14fbae68ffe2f61dc6faaf.png) |


## ğŸ› ï¸ æŠ€æœ¯æ ˆ

- **åç«¯**
  - **æ ¸å¿ƒæ¡†æ¶**: Spring Boot 3.3.1
  - **æ•°æ®åº“**: MySQL 5.7.40
  - **ORM**: MyBatis-Plus
  - **å®‰å…¨**: Spring Security, JWT
  - **HTTPå®¢æˆ·ç«¯**: OkHttp
- **å‰ç«¯**
  - **æ ¸å¿ƒæ¡†æ¶**: React 18.3.1
  - **UI åº“**: Ant Design
  - **HTTPå®¢æˆ·ç«¯**: Axios
- **éƒ¨ç½²**
  - **å®¹å™¨åŒ–**: Docker, Docker Compose
  - **Web æœåŠ¡å™¨**: Nginx

## ğŸš€ å¿«é€Ÿå¼€å§‹

ä½ å¯ä»¥é€‰æ‹©æœ¬åœ°è¿è¡Œï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ Docker Compose ä¸€é”®éƒ¨ç½²ã€‚

### 1. Docker Compose (æœ¬åœ°æ„å»º)

è¿™æ˜¯æœ€ç®€å•çš„å¯åŠ¨æ–¹å¼ï¼Œé€‚ç”¨äºå¸Œæœ›æœ¬åœ°æ„å»ºé•œåƒçš„ç”¨æˆ·ã€‚è¯·ç¡®ä¿ä½ å·²ç»å®‰è£…äº† Docker å’Œ Docker Composeã€‚

1.  **ä¿®æ”¹é…ç½®**
    - ä¿®æ”¹ `docker-compose.yml` ä¸­çš„ `JWT_SECRET` ã€`ADMIN_USERNAME` å’Œ `ADMIN_PASSWORD`ã€‚
    - ï¼ˆå¯é€‰ï¼‰å¦‚æœéœ€è¦ï¼Œå¯ä»¥ä¿®æ”¹ `src/main/resources/application-docker.yaml` ä¸­çš„æ•°æ®åº“è¿æ¥ä¿¡æ¯ï¼Œç¡®ä¿ä¸ `docker-compose.yml` ä¸­å®šä¹‰çš„ä¸€è‡´ã€‚

2.  **æ„å»ºå¹¶å¯åŠ¨**
    åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹æ‰§è¡Œï¼š
    ```bash
    docker-compose up --build -d
    ```

3.  **è®¿é—®åº”ç”¨**
    - **å‰ç«¯**: `http://localhost:8080`
    - **åç«¯ API**: `http://localhost:8080/api`

### 2. Docker Compose (ç”Ÿäº§ç¯å¢ƒ/é¢„æ„å»ºé•œåƒ)

æ­¤æ–¹å¼é€‚ç”¨äºå¸Œæœ›ç›´æ¥æ‹‰å–é¢„æ„å»ºé•œåƒï¼ˆåç«¯ `app` å’Œå‰ç«¯ `frontend`ï¼‰çš„ç”¨æˆ·ï¼Œæ— éœ€æœ¬åœ°æ„å»ºã€‚Nginx é•œåƒå°†ä¼šåœ¨æœ¬åœ°æ„å»ºï¼Œå› ä¸ºå®ƒåŒ…å«äº†è‡ªå®šä¹‰é…ç½®ã€‚

1.  **å‰ææ¡ä»¶**
    è¯·ç¡®ä¿ä½ å·²ç»å®‰è£…äº† Docker å’Œ Docker Composeã€‚

2.  **åˆ›å»º `docker-compose.prod.yml` æ–‡ä»¶**
    åœ¨ä½ çš„éƒ¨ç½²ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªåä¸º `docker-compose.prod.yml` çš„æ–‡ä»¶ï¼Œå¹¶å°†ä»¥ä¸‹å†…å®¹å¤åˆ¶ç²˜è´´åˆ°æ–‡ä»¶ä¸­ï¼š

    ```yaml
    version: '3.8'

    services:
      mysql: # æ ¹æ®è‡ªå·±çš„éœ€æ±‚ï¼Œå¯ä»¥ä½¿ç”¨æœ¬åœ°è‡ªå·±çš„mysql â‰¥ 5.7.40ï¼Œè¯¥é…ç½®å¯ä»¥å»æ‰
        image: mysql:5.7.40
        container_name: local_img_bed_mysql
        restart: always
        environment:
          MYSQL_ROOT_PASSWORD: your_mysql_root_password # ä½ çš„æ•°æ®åº“rootå¯†ç 
          MYSQL_DATABASE: local_img_bed # æ•°æ®åº“å
          MYSQL_USER: local_img_bed_user  # æ•°æ®åº“ç”¨æˆ·
          MYSQL_PASSWORD: your_mysql_password # æ•°æ®åº“å¯†ç 
        ports:
          - "13336:3306" # MySQLç«¯å£æ˜ å°„ï¼Œå·¦ä¾§ä¸ºå®¿ä¸»æœºç«¯å£ï¼Œå³ä¾§ä¸ºå®¹å™¨ç«¯å£ï¼Œå¯ä¿®æ”¹å®¿ä¸»æœºç«¯å£
        volumes:
          - ./data/mysql:/var/lib/mysql # æŒä¹…åŒ–MySQLæ•°æ®åˆ°å®¿ä¸»æœºå½“å‰ç›®å½•ä¸‹çš„data/mysqlæ–‡ä»¶å¤¹ï¼Œå¦‚æœéœ€è¦ï¼Œè¯·ä¿®æ”¹ä¸ºå…¶ä»–åœ°å€ï¼Œé»˜è®¤ä¸º ./data/mysql

      app: # åç«¯æœåŠ¡
        image: zy1234567/local_img_bed-app:latest
        container_name: local_img_bed_app
        restart: always
        environment:
          - DB_URL=jdbc:mysql://mysql:3306/local_img_bed?useSSL=false&serverTimezone=Asia/Shanghai # æ•°æ®åº“è¿æ¥URLï¼Œå¦‚æœMySQLæœåŠ¡åæˆ–ç«¯å£æœ‰å˜åŠ¨ï¼Œè¯·ä¿®æ”¹
          - DB_USERNAME=local_img_bed_user # æ•°æ®åº“ç”¨æˆ·ï¼Œå’Œä¸Šé¢æ•°æ®åº“é…ç½®ä¿æŒä¸€è‡´
          - DB_PASSWORD=your_mysql_password # æ•°æ®åº“å¯†ç ï¼Œå’Œä¸Šé¢æ•°æ®åº“é…ç½®ä¿æŒä¸€è‡´
          - JWT_SECRET=${JWT_SECRET}  # JWTå¯†é’¥ï¼Œå»ºè®®é•¿åº¦â‰¥32å­—ç¬¦ï¼Œè¯·ä¿®æ”¹ä¸ºè‡ªå·±çš„
          - ADMIN_USERNAME=${ADMIN_USERNAME} # ç®¡ç†å‘˜ç™»å½•è´¦å·ï¼Œè¯·ä¿®æ”¹
          - ADMIN_PASSWORD=${ADMIN_PASSWORD} # ç®¡ç†å‘˜ç™»å½•å¯†ç ï¼Œè¯·ä¿®æ”¹
          - IMAGE_STORAGE_ROOT_PATH=/data/images # å‘ŠçŸ¥Spring Bootå®¹å™¨å†…çš„å›¾ç‰‡è·¯å¾„ï¼Œé€šå¸¸æ— éœ€ä¿®æ”¹
        volumes:
          - ./data/images:/data/images # å°†å›¾ç‰‡å­˜å‚¨åœ¨å®¿ä¸»æœºå½“å‰ç›®å½•ä¸‹çš„data/imagesæ–‡ä»¶å¤¹ï¼Œå¦‚æœéœ€è¦ï¼Œè¯·ä¿®æ”¹ä¸ºè‡ªå·±æœ¬åœ°å­˜å‚¨ç£ç›˜ï¼Œé»˜è®¤ä¸º ./data/images
        depends_on:
          - mysql

      frontend: # å‰ç«¯æœåŠ¡
        image: zy1234567/local_img_bed-frontend:latest
        container_name: local_img_bed_frontend
        restart: always

      nginx-proxy: # nginx
        image: zy1234567/local_img_bed-nginx-proxy:latest # ä½¿ç”¨å·²ç»æ‰“åŒ…å¥½çš„nginxæ˜¯å› ä¸ºé‡Œé¢æ·»åŠ äº†æ¥å£è½¬å‘å’Œå›¾ç‰‡æŸ¥çœ‹çš„çš„é…ç½®æ–‡ä»¶ï¼Œä¸ç”¨æ‰‹åŠ¨é…ç½®
        container_name: local_img_bed_nginx_proxy
        restart: always
        ports:
          - "8198:80" # Nginxç«¯å£æ˜ å°„ï¼Œå·¦ä¾§ä¸ºå®¿ä¸»æœºç«¯å£ï¼Œå³ä¾§ä¸ºå®¹å™¨ç«¯å£ï¼Œå¯ä¿®æ”¹å®¿ä¸»æœºç«¯å£ä»¥é¿å…å†²çª
        volumes:
          - ./data/images:/var/www/images:ro # ä»¥åªè¯»æ–¹å¼æŒ‚è½½å›¾ç‰‡å·ï¼Œä¾›Nginxè¯»å–ï¼Œè·¯å¾„ä¸appæœåŠ¡ä¿æŒä¸€è‡´
        depends_on:
          - app
          - frontend
    ```

3.  **é…ç½®ç¯å¢ƒå˜é‡**
    åœ¨ `docker-compose.prod.yml` æ‰€åœ¨çš„ç›®å½•ä¸‹ï¼Œåˆ›å»ºä¸€ä¸ª `.env` æ–‡ä»¶ï¼Œå¹¶è®¾ç½®ä»¥ä¸‹ç¯å¢ƒå˜é‡ï¼š
    ```
    MYSQL_ROOT_PASSWORD=your_mysql_root_password # ä½ çš„æ•°æ®åº“rootå¯†ç 
    MYSQL_DATABASE=local_img_bed # æ•°æ®åº“å
    MYSQL_USER=local_img_bed_user  # æ•°æ®åº“ç”¨æˆ·
    MYSQL_PASSWORD=your_mysql_password # æ•°æ®åº“å¯†ç 
    JWT_SECRET=your_jwt_secret_key # JWTå¯†é’¥ï¼Œå»ºè®®é•¿åº¦â‰¥32å­—ç¬¦
    ADMIN_USERNAME=your_admin_username # ç®¡ç†å‘˜ç™»å½•è´¦å·
    ADMIN_PASSWORD=your_admin_password # ç®¡ç†å‘˜ç™»å½•å¯†ç 
    ```
    **é‡è¦æç¤ºï¼š** è¯·åŠ¡å¿…å°† `your_...` æ›¿æ¢ä¸ºä½ çš„å®é™…å€¼ã€‚

4.  **å¯åŠ¨æœåŠ¡**
    åœ¨ `docker-compose.prod.yml` æ–‡ä»¶æ‰€åœ¨çš„ç›®å½•ä¸‹è¡Œï¼š
    ```bash
    docker-compose -f docker-compose.prod.yml up -d
    ```
    æ­¤å‘½ä»¤ä¼šæ‹‰å– `app` å’Œ `frontend` çš„é¢„æ„å»ºé•œåƒï¼Œå¹¶åœ¨æœ¬åœ°æ„å»º `nginx-proxy` é•œåƒã€‚

5.  **è®¿é—®åº”ç”¨**
    - **å‰ç«¯**: `http://localhost:8198`
    - **åç«¯ API**: `http://localhost:8198/api`
    ï¼ˆè¯·æ³¨æ„ï¼Œç«¯å£å·²æ›´æ”¹ä¸º `8198` ä»¥é¿å…ä¸é»˜è®¤ `8080` å†²çªï¼Œè¿™åœ¨ `docker-compose.prod.yml` ä¸­å·²é…ç½®ï¼‰

6.  **æ•°æ®åº“åˆå§‹åŒ–æ³¨æ„äº‹é¡¹**
    åç«¯ `app` æœåŠ¡ä¼šåœ¨é¦–æ¬¡å¯åŠ¨æ—¶è‡ªåŠ¨åˆå§‹åŒ–æ•°æ®åº“è¡¨ç»“æ„ã€‚å¦‚æœéœ€è¦é‡æ–°åˆå§‹åŒ–æ•°æ®åº“ï¼ˆä¾‹å¦‚ï¼Œä»å¤´å¼€å§‹ï¼‰ï¼Œè¯·åœ¨å¯åŠ¨æœåŠ¡ä¹‹å‰åˆ é™¤ `mysql_data` Docker å·ï¼š
    ```bash
    docker-compose -f docker-compose.prod.yml down -v
    ```
    ç„¶åå†æ¬¡è¿è¡Œã€‚

### 3. æœ¬åœ°å¼€å‘ç¯å¢ƒè¿è¡Œ

**ç¯å¢ƒè¦æ±‚:**
- Java 17+
- Maven 3.6+
- Node.js 16+
- MySQL 5.7.40+

**æ­¥éª¤:**

1.  **æ•°æ®åº“åˆå§‹åŒ–**
    - åˆ›å»ºä¸€ä¸ªåä¸º `local_img_bed` çš„æ•°æ®åº“ã€‚
    - å°† `mysql-init-scripts/local_img_bed.sql` æ–‡ä»¶å¯¼å…¥åˆ°ä½ åˆ›å»ºçš„æ•°æ®åº“ä¸­ã€‚

2.  **åç«¯é…ç½®ä¸å¯åŠ¨**
    - ä¿®æ”¹ `src/main/resources/application-local.yaml` ä¸­çš„æ•°æ®åº“è¿æ¥ä¿¡æ¯ï¼ˆç”¨æˆ·åå’Œå¯†ç ï¼‰ã€‚
    - åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹ï¼Œä½¿ç”¨ Maven å¯åŠ¨åç«¯æœåŠ¡ï¼š
      ```bash
      # æ¿€æ´» local profile
      ./mvnw spring-boot:run -Dspring-boot.run.profiles=local
      ```
    - æœåŠ¡å°†è¿è¡Œåœ¨ `http://localhost:8888`ã€‚

3.  **å‰ç«¯é…ç½®ä¸å¯åŠ¨**
    - è¿›å…¥ `frontend` ç›®å½•ï¼š
      ```bash
      cd frontend
      ```
    - å®‰è£…ä¾èµ–ï¼š
      ```bash
      npm install
      ```
    - å¯åŠ¨å‰ç«¯å¼€å‘æœåŠ¡å™¨ï¼š
      ```bash
      npm start
      ```
    - å‰ç«¯å°†è¿è¡Œåœ¨ `http://localhost:3000`ã€‚æ­¤æ—¶å‰ç«¯ä¼šé€šè¿‡ `package.json` ä¸­çš„ `proxy` é…ç½®å°† API è¯·æ±‚è½¬å‘åˆ° `http://localhost:8888`ã€‚

## ğŸ“ é¡¹ç›®ç»“æ„

```
.
â”œâ”€â”€ frontend/              # React å‰ç«¯é¡¹ç›®
â”‚   â”œâ”€â”€ public/
â”‚   â””â”€â”€ src/
â”‚       â”œâ”€â”€ components/    # React ç»„ä»¶
â”‚       â”œâ”€â”€ pages/         # é¡µé¢
â”‚       â””â”€â”€ services/      # API æœåŠ¡
â”œâ”€â”€ src/main/              # Spring Boot åç«¯é¡¹ç›®
â”‚   â”œâ”€â”€ java/
â”‚   â”‚   â””â”€â”€ com/example/local_img_bed/
â”‚   â”‚       â”œâ”€â”€ config/    # é…ç½®ç±»
â”‚   â”‚       â”œâ”€â”€ controller/# æ§åˆ¶å™¨
â”‚   â”‚       â”œâ”€â”€ entity/    # å®ä½“ç±»
â”‚   â”‚       â”œâ”€â”€ mapper/    # MyBatis Mapper
â”‚   â”‚       â””â”€â”€ service/   # ä¸šåŠ¡é€»è¾‘
â”‚   â””â”€â”€ resources/
â”‚       â”œâ”€â”€ mapper/        # MyBatis XML
â”‚       â””â”€â”€ application.yaml # é…ç½®æ–‡ä»¶
â”œâ”€â”€ docker-compose.yml     # Docker ç¼–æ’æ–‡ä»¶ (æœ¬åœ°æ„å»º)
â”œâ”€â”€ docker-compose.prod.yml # Docker ç¼–æ’æ–‡ä»¶ (ç”Ÿäº§ç¯å¢ƒ/é¢„æ„å»ºé•œåƒ)
â”œâ”€â”€ Dockerfile             # åç«¯ Dockerfile
â””â”€â”€ nginx/                 # Nginx é…ç½®å’Œ Dockerfile
```

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Pull Request æˆ– Issue æ¥ä¸ºé¡¹ç›®åšå‡ºè´¡çŒ®ï¼
